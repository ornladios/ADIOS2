From f6096d97e31f3a0d2b34f0ec74a39f7a9bca9d99 Mon Sep 17 00:00:00 2001
From: Scott Wittenburg <scott.wittenburg@kitware.com>
Date: Tue, 14 Oct 2025 15:59:47 -0600
Subject: [PATCH] adios2: add xrootd variant

---
 var/spack/repos/builtin/packages/adios2/package.py | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/var/spack/repos/builtin/packages/adios2/package.py b/var/spack/repos/builtin/packages/adios2/package.py
index 8870366397..b3668c7e7b 100644
--- a/var/spack/repos/builtin/packages/adios2/package.py
+++ b/var/spack/repos/builtin/packages/adios2/package.py
@@ -107,6 +107,8 @@ class Adios2(CMakePackage, CudaPackage, ROCmPackage):
         description="Enable support for in situ visualization plugin using ParaView Catalyst",
     )
 
+    variant("xrootd", default=True, description="Enable the XRootD")
+
     # Optional language bindings, C++11 and C always provided
     variant("kokkos", default=False, when="@2.9:", description="Enable Kokkos support")
     variant("sycl", default=False, when="@2.10:", description="Enable SYCL support")
@@ -207,6 +209,8 @@ class Adios2(CMakePackage, CudaPackage, ROCmPackage):
     depends_on("aws-sdk-cpp", when="+aws")
     depends_on("libcatalyst@2", when="+libcatalyst")
 
+    depends_on("xrootd~davix", when="+xrootd")
+
     # error: invalid use of incomplete type 'PyFrameObject' {aka 'struct _frame'}
     conflicts("^python@3.11:", when="@:2.7")
 
@@ -273,6 +277,7 @@ def cmake_args(self):
             from_variant("CMAKE_POSITION_INDEPENDENT_CODE", "pic"),
             from_variant("BUILD_SHARED_LIBS", "shared"),
             from_variant("ADIOS2_USE_AWSSDK", "aws"),
+            from_variant("ADIOS2_USE_XRootD", "xrootd"),
             from_variant("ADIOS2_USE_Blosc", "blosc"),
             from_variant("ADIOS2_USE_Blosc2", "blosc2"),
             from_variant("ADIOS2_USE_BZip2", "bzip2"),
-- 
2.34.1

